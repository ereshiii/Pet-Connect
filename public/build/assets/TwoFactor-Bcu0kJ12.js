import{d as v,r as T,m as _,a as p,e as n,w as a,i as e,u as o,h as i,b as d,j as r,p as F}from"./vue-vendor-DmxhFomr.js";import{_ as E}from"./HeadingSmall.vue_vue_type_script_setup_true_lang-BVYCrzPZ.js";import{u as k,_ as C,a as S}from"./TwoFactorSetupModal.vue_vue_type_script_setup_true_lang-Dnp7XG68.js";import{t as c,a as f}from"./ui-components-Dj0vw2vK.js";import{c as g}from"./admin-j62zy8g0.js";import{_ as x}from"./Layout.vue_vue_type_script_setup_true_lang-DJYg1gCj.js";import{h as A}from"./inertia-vendor-BXJnWAhq.js";import{ab as w,ay as O}from"./lucide-vendor-BUHJwLVO.js";import"./vendor-BqPpK9Aj.js";import"./leaflet-vendor-Do2TvcFZ.js";import"./index-U6g8M1fB.js";import"./auth-a3bL7d2J.js";import"./ui-vendor-B7N-G3Ug.js";import"./utility-vendor-CjxovF-h.js";import"./Heading.vue_vue_type_script_setup_true_lang-FNXLTphu.js";const $={class:"space-y-6"},B={key:0,class:"flex flex-col items-start justify-start space-y-4"},q={key:1,class:"flex flex-col items-start justify-start space-y-4"},D={class:"relative inline"},j={method:"DELETE",action:"/user/two-factor-authentication"},Q=v({__name:"TwoFactor",props:{requiresConfirmation:{type:Boolean,default:!1},twoFactorEnabled:{type:Boolean,default:!1}},setup(u){const h=[{title:"Two-Factor Authentication",href:"/clinic/settings/two-factor"}],{hasSetupData:y,clearTwoFactorAuthData:b}=k(),s=T(!1);return _(()=>{b()}),(m,t)=>(n(),p(g,{breadcrumbs:h},{default:a(()=>[e(o(A),{title:"Two-Factor Authentication"}),e(x,null,{default:a(()=>[i("div",$,[e(E,{title:"Two-Factor Authentication",description:"Manage your two-factor authentication settings"}),u.twoFactorEnabled?(n(),d("div",q,[e(o(c),{variant:"default"},{default:a(()=>[...t[7]||(t[7]=[r("Enabled",-1)])]),_:1}),t[9]||(t[9]=i("p",{class:"text-muted-foreground"}," With two-factor authentication enabled, you will be prompted for a secure, random pin during login, which you can retrieve from the TOTP-supported application on your phone. ",-1)),e(C),i("div",D,[i("form",j,[e(o(f),{variant:"destructive",type:"submit"},{default:a(()=>[e(o(O)),t[8]||(t[8]=r(" Disable 2FA ",-1))]),_:1})])])])):(n(),d("div",B,[e(o(c),{variant:"destructive"},{default:a(()=>[...t[3]||(t[3]=[r("Disabled",-1)])]),_:1}),t[6]||(t[6]=i("p",{class:"text-muted-foreground"}," When you enable two-factor authentication, you will be prompted for a secure pin during login. This pin can be retrieved from a TOTP-supported application on your phone. ",-1)),i("div",null,[o(y)?(n(),p(o(f),{key:0,onClick:t[0]||(t[0]=l=>s.value=!0)},{default:a(()=>[e(o(w)),t[4]||(t[4]=r("Continue Setup ",-1))]),_:1})):(n(),d("form",{key:1,method:"POST",action:"/user/two-factor-authentication",onSubmit:t[1]||(t[1]=F(l=>{m.fetch("/user/two-factor-authentication",{method:"POST",headers:{"X-CSRF-TOKEN":m.document.querySelector("meta[name=csrf-token]").content,Accept:"application/json"}}).then(()=>s.value=!0)},["prevent"]))},[e(o(f),{type:"submit"},{default:a(()=>[e(o(w)),t[5]||(t[5]=r("Enable 2FA ",-1))]),_:1})],32))])])),e(S,{isOpen:s.value,"onUpdate:isOpen":t[2]||(t[2]=l=>s.value=l),requiresConfirmation:u.requiresConfirmation,twoFactorEnabled:u.twoFactorEnabled},null,8,["isOpen","requiresConfirmation","twoFactorEnabled"])])]),_:1})]),_:1}))}});export{Q as default};
