import{u as $,a as U,h as F,l as C}from"./inertia-vendor-BXJnWAhq.js";import{u as E}from"./useToast-Dsd6g505.js";import{_ as j}from"./DeleteUser.vue_vue_type_script_setup_true_lang-Dx7LTKg3.js";import{_ as B}from"./HeadingSmall.vue_vue_type_script_setup_true_lang-BVYCrzPZ.js";import{a as g,D as y,E as x}from"./ui-components-Dj0vw2vK.js";import{c as R}from"./admin-j62zy8g0.js";import{_ as S}from"./Layout.vue_vue_type_script_setup_true_lang-DJYg1gCj.js";import{d as D,r as V,a as h,e as f,w as n,i as a,u as e,h as i,b as m,t as _,g as d,j as u}from"./vue-vendor-DmxhFomr.js";import"./vendor-BqPpK9Aj.js";import"./leaflet-vendor-Do2TvcFZ.js";import"./toast-vendor-DVSe2vMM.js";import"./auth-a3bL7d2J.js";import"./lucide-vendor-BUHJwLVO.js";import"./ui-vendor-B7N-G3Ug.js";import"./utility-vendor-CjxovF-h.js";import"./Heading.vue_vue_type_script_setup_true_lang-FNXLTphu.js";const N={class:"flex flex-col space-y-6"},G={class:"flex items-center gap-4"},T={class:"relative w-24 h-24 rounded-full bg-gray-100 overflow-hidden flex items-center justify-center cursor-pointer group hover:opacity-80 transition-opacity"},z=["src"],M={key:1,class:"text-xl text-gray-500"},q={class:"flex flex-col gap-2"},A={class:"flex gap-2"},I={method:"PATCH",action:"/clinic/settings/profile",class:"space-y-6"},J={class:"grid gap-2"},L={class:"grid gap-2"},H={key:0},O={class:"-mt-4 text-sm text-muted-foreground"},W={key:0,class:"mt-2 text-sm font-medium text-green-600"},Y={class:"flex items-center gap-4"},de=D({__name:"Profile",props:{mustVerifyEmail:{type:Boolean},status:{}},setup(v){const r=E(),b=[{title:"Profile settings",href:"/clinic/settings/profile"}],l=$().props.auth.user,t=U({photo:null,remove:!1}),c=V(l.profile?.profile_image_url?`${l.profile.profile_image_url}?v=${Date.now()}`:null),k=s=>{const o=s.target,p=o.files&&o.files[0];if(p){if(p.size>10*1024*1024){r.error("File size must be less than 10MB");return}if(!["image/jpeg","image/png","image/jpg","image/gif","image/svg+xml","image/webp"].includes(p.type)){r.error("File must be JPEG, PNG, JPG, GIF, SVG, or WEBP");return}t.photo=p,t.remove=!1,c.value=URL.createObjectURL(p),r.info(`Selected: ${p.name} (${(p.size/1024/1024).toFixed(2)}MB)`)}},P=()=>{if(!t.photo){r.error("Please select a photo first");return}console.log("Uploading profile photo:",t.photo.name,t.photo.type,t.photo.size),r.info("Uploading photo..."),t.post("/clinic/settings/profile/photo",{forceFormData:!0,preserveState:!1,onSuccess:s=>{console.log("Profile photo upload successful",s),r.success("Profile photo uploaded successfully!"),t.reset(),s.props.auth?.user?.profile?.profile_image_url&&(c.value=`${s.props.auth.user.profile.profile_image_url}?v=${Date.now()}`)},onError:s=>{console.error("Upload errors:",s),s.photo?r.error(`Upload failed: ${s.photo}`):s.message?r.error(`Upload failed: ${s.message}`):r.error("Upload failed: Unknown error occurred")},onFinish:()=>{console.log("Upload request finished")}})},w=()=>{confirm("Remove profile photo?")&&(console.log("Removing profile photo"),r.info("Removing photo..."),t.photo=null,t.remove=!0,t.post("/clinic/settings/profile/photo",{forceFormData:!0,preserveState:!1,onSuccess:s=>{console.log("Profile photo removed successfully",s),r.success("Profile photo removed successfully!"),t.reset(),c.value=null},onError:s=>{console.error("Remove errors:",s),r.error("Failed to remove photo")}}))};return(s,o)=>(f(),h(R,{breadcrumbs:b},{default:n(()=>[a(e(F),{title:"Profile settings"}),a(S,null,{default:n(()=>[i("div",N,[a(B,{title:"Profile information",description:"Update your name and email address"}),i("div",G,[i("label",T,[i("input",{type:"file",name:"photo",class:"hidden",accept:"image/*",onChange:k},null,32),c.value||e(l).profile?.profile_image?(f(),m("img",{key:0,src:c.value||`/storage/${e(l).profile?.profile_image}?v=${Date.now()}`,alt:"Profile",class:"w-full h-full object-cover"},null,8,z)):(f(),m("div",M,_(e(l).profile?.initials||e(l).name[0]),1)),o[0]||(o[0]=i("div",{class:"absolute inset-0 bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center"},[i("span",{class:"text-white text-xs font-medium"},"Change")],-1))]),i("div",q,[i("div",A,[c.value?(f(),h(e(g),{key:0,type:"button",onClick:P,disabled:e(t).processing},{default:n(()=>[u(_(e(t).processing?"Uploading...":"Upload"),1)]),_:1},8,["disabled"])):d("",!0),e(l).profile?.profile_image?(f(),h(e(g),{key:1,type:"button",variant:"outline",onClick:w,disabled:e(t).processing},{default:n(()=>[u(_(e(t).processing?"Removing...":"Remove"),1)]),_:1},8,["disabled"])):d("",!0)]),o[1]||(o[1]=i("p",{class:"text-xs text-muted-foreground"},"Accepted: jpeg, png, jpg, gif, svg, webp. Max 10MB.",-1))])]),i("form",I,[i("div",J,[a(e(y),{for:"name"},{default:n(()=>[...o[2]||(o[2]=[u("Name",-1)])]),_:1}),a(e(x),{id:"name",class:"mt-1 block w-full",name:"name","default-value":e(l).name,required:"",autocomplete:"name",placeholder:"Full name"},null,8,["default-value"])]),i("div",L,[a(e(y),{for:"email"},{default:n(()=>[...o[3]||(o[3]=[u("Email address",-1)])]),_:1}),a(e(x),{id:"email",type:"email",class:"mt-1 block w-full",name:"email","default-value":e(l).email,required:"",autocomplete:"username",placeholder:"Email address"},null,8,["default-value"])]),v.mustVerifyEmail&&!e(l).email_verified_at?(f(),m("div",H,[i("p",O,[o[5]||(o[5]=u(" Your email address is unverified. ",-1)),a(e(C),{href:"/email/verification-notification",as:"button",class:"text-foreground underline decoration-neutral-300 underline-offset-4 transition-colors duration-300 ease-out hover:decoration-current! dark:decoration-neutral-500"},{default:n(()=>[...o[4]||(o[4]=[u(" Click here to resend the verification email. ",-1)])]),_:1})]),v.status==="verification-link-sent"?(f(),m("div",W," A new verification link has been sent to your email address. ")):d("",!0)])):d("",!0),i("div",Y,[a(e(g),{type:"submit"},{default:n(()=>[...o[6]||(o[6]=[u("Save",-1)])]),_:1})])])]),a(j)]),_:1})]),_:1}))}});export{de as default};
