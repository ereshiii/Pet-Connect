import{O as $,c as U}from"./admin-j62zy8g0.js";import{s as F}from"./auth-a3bL7d2J.js";import{u as C,a as E,h as j,l as B}from"./inertia-vendor-BXJnWAhq.js";import{u as R}from"./useToast-Dsd6g505.js";import{_ as S}from"./DeleteUser.vue_vue_type_script_setup_true_lang-Dx7LTKg3.js";import{_ as D}from"./HeadingSmall.vue_vue_type_script_setup_true_lang-BVYCrzPZ.js";import{a as g,D as y,E as x}from"./ui-components-Dj0vw2vK.js";import{_ as V}from"./Layout.vue_vue_type_script_setup_true_lang-gmxanThf.js";import{d as N,r as G,a as _,e as u,w as n,i as l,u as e,h as i,b as d,t as h,g as c,j as f}from"./vue-vendor-DmxhFomr.js";import"./vendor-BqPpK9Aj.js";import"./leaflet-vendor-Do2TvcFZ.js";import"./lucide-vendor-BUHJwLVO.js";import"./utility-vendor-CjxovF-h.js";import"./toast-vendor-DVSe2vMM.js";import"./ui-vendor-B7N-G3Ug.js";import"./Heading.vue_vue_type_script_setup_true_lang-FNXLTphu.js";import"./index-U6g8M1fB.js";const T={class:"flex flex-col space-y-6"},z={class:"flex items-center gap-4"},M={class:"relative w-24 h-24 rounded-full bg-gray-100 overflow-hidden flex items-center justify-center cursor-pointer group hover:opacity-80 transition-opacity"},q=["src"],A={key:1,class:"text-xl text-gray-500"},I={class:"flex flex-col gap-2"},J={class:"flex gap-2"},L={method:"PATCH",action:"/settings/profile",class:"space-y-6"},O={class:"grid gap-2"},H={class:"grid gap-2"},W={key:0},Y={class:"-mt-4 text-sm text-muted-foreground"},K={key:0,class:"mt-2 text-sm font-medium text-green-600"},Q={class:"flex items-center gap-4"},he=N({__name:"Profile",props:{mustVerifyEmail:{type:Boolean},status:{}},setup(v){const r=R(),b=[{title:"Profile settings",href:$().url}],a=C().props.auth.user,t=E({photo:null,remove:!1}),m=G(a.profile?.profile_image_url?`${a.profile.profile_image_url}?v=${Date.now()}`:null),k=s=>{const o=s.target,p=o.files&&o.files[0];if(p){if(p.size>10*1024*1024){r.error("File size must be less than 10MB");return}if(!["image/jpeg","image/png","image/jpg","image/gif","image/svg+xml","image/webp"].includes(p.type)){r.error("File must be JPEG, PNG, JPG, GIF, SVG, or WEBP");return}t.photo=p,t.remove=!1,m.value=URL.createObjectURL(p),r.info(`Selected: ${p.name} (${(p.size/1024/1024).toFixed(2)}MB)`)}},P=()=>{if(!t.photo){r.error("Please select a photo first");return}console.log("Uploading profile photo:",t.photo.name,t.photo.type,t.photo.size),r.info("Uploading photo..."),t.post("/settings/profile/photo",{forceFormData:!0,preserveState:!1,onSuccess:s=>{console.log("Profile photo upload successful",s),r.success("Profile photo uploaded successfully!"),t.reset(),s.props.auth?.user?.profile?.profile_image_url&&(m.value=`${s.props.auth.user.profile.profile_image_url}?v=${Date.now()}`)},onError:s=>{console.error("Upload errors:",s),s.photo?r.error(`Upload failed: ${s.photo}`):s.message?r.error(`Upload failed: ${s.message}`):r.error("Upload failed: Unknown error occurred")},onFinish:()=>{console.log("Upload request finished")}})},w=()=>{confirm("Remove profile photo?")&&(console.log("Removing profile photo"),r.info("Removing photo..."),t.photo=null,t.remove=!0,t.post("/settings/profile/photo",{forceFormData:!0,preserveState:!1,onSuccess:s=>{console.log("Profile photo removed successfully",s),r.success("Profile photo removed successfully!"),t.reset(),m.value=null},onError:s=>{console.error("Remove errors:",s),r.error("Failed to remove photo")}}))};return(s,o)=>(u(),_(U,{breadcrumbs:b},{default:n(()=>[l(e(j),{title:"Profile settings"}),l(V,null,{default:n(()=>[i("div",T,[l(D,{title:"Profile information",description:"Update your name and email address"}),i("div",z,[i("label",M,[i("input",{type:"file",name:"photo",class:"hidden",accept:"image/*",onChange:k},null,32),m.value||e(a).profile?.profile_image_url?(u(),d("img",{key:0,src:m.value||`${e(a).profile?.profile_image_url}?v=${Date.now()}`,alt:"Profile",class:"w-full h-full object-cover"},null,8,q)):(u(),d("div",A,h(e(a).profile?.initials||e(a).name[0]),1)),o[0]||(o[0]=i("div",{class:"absolute inset-0 bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center"},[i("span",{class:"text-white text-xs font-medium"},"Change")],-1))]),i("div",I,[i("div",J,[m.value?(u(),_(e(g),{key:0,type:"button",onClick:P,disabled:e(t).processing},{default:n(()=>[f(h(e(t).processing?"Uploading...":"Upload"),1)]),_:1},8,["disabled"])):c("",!0),e(a).profile?.profile_image?(u(),_(e(g),{key:1,type:"button",variant:"outline",onClick:w,disabled:e(t).processing},{default:n(()=>[f(h(e(t).processing?"Removing...":"Remove"),1)]),_:1},8,["disabled"])):c("",!0)]),o[1]||(o[1]=i("p",{class:"text-xs text-muted-foreground"},"Accepted: jpeg, png, jpg, gif, svg, webp. Max 10MB.",-1))])]),i("form",L,[i("div",O,[l(e(y),{for:"name"},{default:n(()=>[...o[2]||(o[2]=[f("Name",-1)])]),_:1}),l(e(x),{id:"name",class:"mt-1 block w-full",name:"name","default-value":e(a).name,required:"",autocomplete:"name",placeholder:"Full name"},null,8,["default-value"])]),i("div",H,[l(e(y),{for:"email"},{default:n(()=>[...o[3]||(o[3]=[f("Email address",-1)])]),_:1}),l(e(x),{id:"email",type:"email",class:"mt-1 block w-full",name:"email","default-value":e(a).email,required:"",autocomplete:"username",placeholder:"Email address"},null,8,["default-value"])]),v.mustVerifyEmail&&!e(a).email_verified_at?(u(),d("div",W,[i("p",Y,[o[5]||(o[5]=f(" Your email address is unverified. ",-1)),l(e(B),{href:e(F)(),as:"button",class:"text-foreground underline decoration-neutral-300 underline-offset-4 transition-colors duration-300 ease-out hover:decoration-current! dark:decoration-neutral-500"},{default:n(()=>[...o[4]||(o[4]=[f(" Click here to resend the verification email. ",-1)])]),_:1},8,["href"])]),v.status==="verification-link-sent"?(u(),d("div",K," A new verification link has been sent to your email address. ")):c("",!0)])):c("",!0),i("div",Q,[l(e(g),{type:"submit"},{default:n(()=>[...o[6]||(o[6]=[f("Save",-1)])]),_:1})])])]),l(S)]),_:1})]),_:1}))}});export{he as default};
