import{d as Z,c as C,r as g,o as J,b as c,e as m,i as y,u as A,w as L,h as e,t as n,j as h,F as $,g as v,q as p,s as B,v as f,n as K}from"./vue-vendor-DmxhFomr.js";import{z as P,c as Q,N as ee,M as te,y as oe}from"./admin-j62zy8g0.js";import{M as re}from"./map-e4zgbuYL.js";import{h as le,r as M}from"./inertia-vendor-BXJnWAhq.js";import{x as se,X as ne}from"./lucide-vendor-BUHJwLVO.js";import{_ as ae}from"./auth-a3bL7d2J.js";import"./vendor-BqPpK9Aj.js";import"./leaflet-vendor-Do2TvcFZ.js";import"./ui-components-Dj0vw2vK.js";import"./ui-vendor-B7N-G3Ug.js";import"./utility-vendor-CjxovF-h.js";const ie={class:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4"},de={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4"},ue={class:"text-sm text-muted-foreground mt-1"},ce={class:"hidden lg:flex gap-2"},me={class:"flex flex-col lg:flex-row gap-4 h-full"},ge={key:0,class:"flex items-center justify-center h-64 bg-card rounded-xl border border-border"},ve={key:0,class:"fixed inset-0 z-[9999] lg:hidden"},pe={class:"absolute inset-y-0 left-0 w-full sm:w-96 bg-card border-r border-border shadow-xl overflow-y-auto"},fe={class:"sticky top-0 z-10 flex items-center justify-between p-4 border-b border-border bg-card"},xe={class:"p-4 space-y-4"},be={class:"flex gap-2 pt-2"},ye={class:"pt-4 border-t border-border"},he={class:"text-xs text-muted-foreground"},ke={key:1,class:"hidden lg:block lg:w-80 bg-card rounded-xl border border-border p-5 z-[1000]"},we={class:"space-y-4"},Ce={key:0,class:"mt-6 pt-4 border-t border-border"},Me={class:"bg-muted border border-border rounded-lg p-3"},Fe={class:"font-semibold text-foreground text-sm"},Ve={class:"text-muted-foreground text-xs mt-1"},Se={class:"flex items-center mt-2 text-xs"},Ae={class:"text-yellow-400"},Le={class:"text-foreground ml-1"},De={class:"text-muted-foreground ml-2"},Ne={class:"flex items-center mt-1 text-xs"},ze={key:0,class:"ml-2 bg-green-900 text-green-200 px-2 py-1 rounded-full text-xs"},_e={class:"mt-4 pt-4 border-t border-border"},$e={class:"text-xs text-muted-foreground"},Be={key:0,class:"mt-2 space-y-1"},je={key:0,class:"text-xs"},Ee={class:"font-medium text-foreground"},We={key:1,class:"text-xs"},Ue={class:"font-medium text-foreground"},qe={key:2,class:"text-xs"},Re={class:"font-medium text-foreground"},Te={class:"flex-1 min-h-0 relative"},Ge={key:0,class:"absolute top-4 left-1/2 transform -translate-x-1/2 z-20 pointer-events-none"},He=Z({__name:"viewMap",props:{clinics:{default:()=>[]},mapCenter:{default:()=>[14.5995,120.9842]},filters:{default:()=>({})}},setup(j){const d=j;console.log("Map view loaded with clinics:",d.clinics.length,"clinics"),console.log("Map view filters from server:",d.filters);const E=[{title:"Clinics",href:"/clinics"},{title:"Map View",href:P().url}];C(()=>d.clinics.map(o=>({id:o.id,lat:o.latitude,lng:o.longitude,title:o.name,description:`${o.address} â€¢ ${o.stars} (${Number(o.rating||0).toFixed(1)}) â€¢ ${o.is_open_24_7?"Open 24/7":o.status}`,type:o.type,clinic:o})));const D=g(d.mapCenter),W=g(12),l=g(null),k=g(!0),x=g(!1),a=g(""),s=g(""),i=g(""),u=g(""),U=o=>(o.id*7%50+.5).toFixed(1),q=o=>parseFloat(U(o)),b=C(()=>{try{let o=d.clinics;if(console.log("Starting with",o.length,"clinics"),console.log("Current filters:",{search:a.value,service:s.value,rating:i.value,distance:u.value}),a.value){const t=a.value.toLowerCase();o=o.filter(r=>r.name.toLowerCase().includes(t)||r.address.toLowerCase().includes(t)),console.log("After search filter:",o.length,"clinics")}if(s.value&&(console.log("Applying service filter:",s.value),console.log("Sample clinic services:",o[0]?.services),o=o.filter(t=>!t.services||!Array.isArray(t.services)?(console.warn("Clinic has invalid services data:",t.name,t.services),!1):t.services.some(w=>{if(typeof w!="string")return console.warn("Service is not a string:",w),!1;const V=w.toLowerCase().trim(),S=s.value.toLowerCase().trim();return V===S||V.includes(S)||S.includes(V)})),console.log("After service filter:",o.length,"clinics")),i.value){const t=parseFloat(i.value);o=o.filter(r=>Number(r.rating||0)>=t),console.log("After rating filter:",o.length,"clinics")}if(u.value){const t=parseFloat(u.value);o=o.filter(r=>q(r)<=t),console.log("After distance filter:",o.length,"clinics")}return console.log("Final filtered clinics:",o.length),o}catch(o){return console.error("Error in filteredClinics computed:",o),d.clinics}}),R=C(()=>b.value.filter(o=>o.latitude&&o.longitude).map(o=>({id:o.id,lat:parseFloat(o.latitude.toString()),lng:parseFloat(o.longitude.toString()),title:o.name,description:`${o.address} â€¢ ${o.stars} (${Number(o.rating||0).toFixed(1)}) â€¢ ${o.is_open_24_7?"Open 24/7":o.status}`,type:o.is_open_24_7?"emergency":"clinic",clinic:o}))),T=o=>{l.value=o.clinic||o,console.log("Clinic selected:",l.value)},G=o=>{console.log("Map ready:",o)},H=o=>{console.log("User location found:",o),D.value=[o.coords.latitude,o.coords.longitude]},O=o=>{console.warn("Location error:",o)},N=()=>{console.log("Filters applied:",{search:a.value,service:s.value,rating:i.value,distance:u.value,resultCount:b.value.length})},F=()=>{a.value="",s.value="",i.value="",u.value=""},Y=()=>{k.value=!k.value},z=()=>{M.visit("/clinics")},_=()=>{console.log("goFullscreen called with filters:",{search:a.value,service:s.value,rating:i.value,distance:u.value});try{M.visit(ee().url,{data:{search:a.value,service:s.value,rating:i.value,distance:u.value}})}catch(o){console.error("Error navigating to fullscreen:",o)}},I=()=>{l.value&&M.visit(te().url,{data:{clinic_id:l.value.id,clinic_name:l.value.name},preserveScroll:!0})},X=()=>{l.value&&M.visit(oe(l.value.id).url)};return C(()=>{const o=new Set;return d.clinics.forEach(t=>{t.services.forEach(r=>o.add(r))}),Array.from(o).sort()}),J(()=>{}),(o,t)=>(m(),c($,null,[y(A(le),{title:"Clinic Map View"}),y(Q,{breadcrumbs:E},{default:L(()=>[e("div",ie,[e("div",de,[e("div",null,[t[12]||(t[12]=e("h1",{class:"text-xl sm:text-2xl font-semibold text-foreground"},"Clinic Locations",-1)),e("p",ue,n(d.clinics.length)+" veterinary clinic"+n(d.clinics.length!==1?"s":"")+" available ",1)]),e("div",ce,[e("button",{onClick:Y,class:"px-4 py-2 border border-border text-foreground rounded-lg hover:bg-muted text-sm"},n(k.value?"Hide":"Show")+" Filters ",1),e("button",{onClick:_,class:"px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 text-sm flex items-center gap-2"},[...t[13]||(t[13]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})],-1),e("span",{class:"hidden xl:inline"},"Fullscreen",-1)])]),e("button",{onClick:z,class:"px-4 py-2 bg-muted text-foreground rounded-lg hover:bg-muted/80 text-sm"}," Back to List ")]),e("div",{class:"flex lg:hidden gap-2 w-full sm:w-auto"},[e("button",{onClick:_,class:"flex-1 sm:flex-none px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 text-sm flex items-center justify-center gap-2"},[...t[14]||(t[14]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})],-1),h(" Fullscreen ",-1)])]),e("button",{onClick:z,class:"flex-1 sm:flex-none px-4 py-2 bg-muted text-foreground rounded-lg hover:bg-muted/80 text-sm"}," Back ")])]),e("div",me,[d.clinics.length===0?(m(),c("div",ge,[...t[15]||(t[15]=[e("div",{class:"text-center text-muted-foreground"},[e("svg",{class:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]),e("h3",{class:"text-lg font-medium text-foreground mb-2"},"No Clinic Locations Available"),e("p",{class:"text-muted-foreground"}," No approved clinics with location data are currently available. ")],-1)])])):(m(),c($,{key:1},[e("button",{onClick:t[0]||(t[0]=r=>x.value=!0),class:"lg:hidden fixed bottom-6 right-6 z-[9999] bg-primary text-primary-foreground p-4 rounded-full shadow-lg hover:bg-primary/90 transition-all"},[y(A(se),{class:"h-5 w-5"})]),x.value?(m(),c("div",ve,[e("div",{class:"absolute inset-0 bg-background/80 backdrop-blur-sm",onClick:t[1]||(t[1]=r=>x.value=!1)}),e("div",pe,[e("div",fe,[t[16]||(t[16]=e("h3",{class:"text-lg font-semibold text-foreground"},"Filters",-1)),e("button",{onClick:t[2]||(t[2]=r=>x.value=!1),class:"p-2 hover:bg-muted rounded-lg transition-colors"},[y(A(ne),{class:"h-5 w-5 text-foreground"})])]),e("div",xe,[e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-foreground mb-2"},"Search",-1)),p(e("input",{"onUpdate:modelValue":t[3]||(t[3]=r=>a.value=r),type:"text",placeholder:"Search clinics...",class:"w-full px-3 py-2 border border-border rounded-lg text-sm bg-background text-foreground"},null,512),[[B,a.value]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-foreground mb-2"},"Category",-1)),p(e("select",{"onUpdate:modelValue":t[4]||(t[4]=r=>s.value=r),class:"w-full px-3 py-2 border border-border rounded-lg text-sm bg-background text-foreground"},[...t[18]||(t[18]=[e("option",{value:""},"All categories",-1),e("option",{value:"consultation"},"Consultation",-1),e("option",{value:"vaccination"},"Vaccination",-1),e("option",{value:"surgery"},"Surgery",-1),e("option",{value:"emergency"},"Emergency",-1),e("option",{value:"grooming"},"Grooming",-1),e("option",{value:"boarding"},"Boarding",-1),e("option",{value:"wellness"},"Wellness",-1),e("option",{value:"laboratory"},"Laboratory",-1),e("option",{value:"marine"},"Marine Care",-1),e("option",{value:"livestock"},"Livestock",-1),e("option",{value:"aquatic"},"Aquatic",-1),e("option",{value:"traditional care"},"Traditional Care",-1),e("option",{value:"disaster response"},"Disaster Response",-1)])],512),[[f,s.value]])]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-foreground mb-2"},"Minimum rating",-1)),p(e("select",{"onUpdate:modelValue":t[5]||(t[5]=r=>i.value=r),class:"w-full px-3 py-2 border border-border rounded-lg text-sm bg-background text-foreground"},[...t[20]||(t[20]=[e("option",{value:""},"Any rating",-1),e("option",{value:"5"},"5 stars",-1),e("option",{value:"4"},"4+ stars",-1),e("option",{value:"3"},"3+ stars",-1),e("option",{value:"2"},"2+ stars",-1)])],512),[[f,i.value]])]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-foreground mb-2"},"Distance",-1)),p(e("select",{"onUpdate:modelValue":t[6]||(t[6]=r=>u.value=r),class:"w-full px-3 py-2 border border-border rounded-lg text-sm bg-background text-foreground"},[...t[22]||(t[22]=[e("option",{value:""},"Any",-1),e("option",{value:"5"},"Within 5 km",-1),e("option",{value:"10"},"Within 10 km",-1),e("option",{value:"25"},"Within 25 km",-1),e("option",{value:"50"},"Within 50 km",-1)])],512),[[f,u.value]])]),e("div",be,[e("button",{onClick:t[7]||(t[7]=r=>{x.value=!1}),class:"flex-1 bg-primary text-primary-foreground py-2 px-4 rounded-lg hover:bg-primary/90 text-sm font-medium"}," Apply "),e("button",{onClick:F,class:"flex-1 border border-border text-foreground py-2 px-4 rounded-lg hover:bg-muted text-sm"}," Clear ")]),e("div",ye,[e("div",he,[e("strong",null,n(b.value.length),1),t[24]||(t[24]=h(" of ",-1)),e("strong",null,n(d.clinics.length),1),t[25]||(t[25]=h(" clinics shown ",-1))])])])])])):v("",!0),k.value?(m(),c("div",ke,[t[39]||(t[39]=e("h3",{class:"text-lg font-semibold text-foreground mb-4"},"Filters",-1)),e("div",we,[e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-foreground mb-2"},"Search",-1)),p(e("input",{"onUpdate:modelValue":t[8]||(t[8]=r=>a.value=r),type:"text",placeholder:"Search clinics...",class:"w-full px-3 py-2 border border-border rounded-lg text-sm bg-background text-foreground"},null,512),[[B,a.value]])]),e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-foreground mb-2"},"Category",-1)),p(e("select",{"onUpdate:modelValue":t[9]||(t[9]=r=>s.value=r),class:"w-full px-3 py-2 border border-border rounded-lg text-sm bg-background text-foreground"},[...t[27]||(t[27]=[e("option",{value:""},"All categories",-1),e("option",{value:"consultation"},"Consultation",-1),e("option",{value:"vaccination"},"Vaccination",-1),e("option",{value:"surgery"},"Surgery",-1),e("option",{value:"emergency"},"Emergency",-1),e("option",{value:"grooming"},"Grooming",-1),e("option",{value:"boarding"},"Boarding",-1),e("option",{value:"wellness"},"Wellness",-1),e("option",{value:"laboratory"},"Laboratory",-1),e("option",{value:"marine"},"Marine Care",-1),e("option",{value:"livestock"},"Livestock",-1),e("option",{value:"aquatic"},"Aquatic",-1),e("option",{value:"traditional care"},"Traditional Care",-1),e("option",{value:"disaster response"},"Disaster Response",-1)])],512),[[f,s.value]])]),e("div",null,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-foreground mb-2"},"Minimum rating",-1)),p(e("select",{"onUpdate:modelValue":t[10]||(t[10]=r=>i.value=r),class:"w-full px-3 py-2 border border-border rounded-lg text-sm bg-background text-foreground"},[...t[29]||(t[29]=[e("option",{value:""},"Any rating",-1),e("option",{value:"5"},"5 stars",-1),e("option",{value:"4"},"4+ stars",-1),e("option",{value:"3"},"3+ stars",-1),e("option",{value:"2"},"2+ stars",-1)])],512),[[f,i.value]])]),e("div",null,[t[32]||(t[32]=e("label",{class:"block text-sm font-medium text-foreground mb-2"},"Distance",-1)),p(e("select",{"onUpdate:modelValue":t[11]||(t[11]=r=>u.value=r),class:"w-full px-3 py-2 border border-border rounded-lg text-sm bg-background text-foreground"},[...t[31]||(t[31]=[e("option",{value:""},"Any",-1),e("option",{value:"5"},"Within 5 km",-1),e("option",{value:"10"},"Within 10 km",-1),e("option",{value:"25"},"Within 25 km",-1),e("option",{value:"50"},"Within 50 km",-1)])],512),[[f,u.value]])]),e("div",{class:"flex gap-2 pt-2"},[e("button",{onClick:N,class:"flex-1 bg-primary text-primary-foreground py-2 px-4 rounded-lg hover:bg-primary/90 text-sm font-medium"}," Apply "),e("button",{onClick:F,class:"flex-1 border border-border text-foreground py-2 px-4 rounded-lg hover:bg-muted text-sm"}," Clear ")])]),l.value?(m(),c("div",Ce,[t[33]||(t[33]=e("h4",{class:"font-medium text-foreground mb-2"},"Selected Clinic",-1)),e("div",Me,[e("h5",Fe,n(l.value.name),1),e("p",Ve,"ðŸ“ "+n(l.value.address),1),e("div",Se,[e("span",Ae,n(l.value.stars),1),e("span",Le,"("+n(Number(l.value.rating||0).toFixed(1))+")",1),e("span",De,n(l.value.total_reviews)+" reviews",1)]),e("div",Ne,[e("span",{class:K(l.value.status_color)},n(l.value.status),3),l.value.is_open_24_7?(m(),c("span",ze," 24/7 ")):v("",!0)]),e("div",{class:"flex gap-2 mt-3"},[e("button",{onClick:I,class:"flex-1 bg-primary text-primary-foreground py-1 px-2 rounded-lg text-xs hover:bg-primary/90"}," Book Appointment "),e("button",{onClick:X,class:"flex-1 border border-border text-foreground py-1 px-2 rounded-lg text-xs hover:bg-muted"}," View Details ")])])])):v("",!0),e("div",_e,[e("div",$e,[e("strong",null,n(b.value.length),1),t[34]||(t[34]=h(" of ",-1)),e("strong",null,n(d.clinics.length),1),t[35]||(t[35]=h(" clinics shown ",-1))]),a.value||s.value||i.value?(m(),c("div",Be,[a.value?(m(),c("div",je,[t[36]||(t[36]=e("span",{class:"text-muted-foreground"},"Search:",-1)),e("span",Ee,n(a.value),1)])):v("",!0),s.value?(m(),c("div",We,[t[37]||(t[37]=e("span",{class:"text-muted-foreground"},"Category:",-1)),e("span",Ue,n(s.value),1)])):v("",!0),i.value?(m(),c("div",qe,[t[38]||(t[38]=e("span",{class:"text-muted-foreground"},"Rating:",-1)),e("span",Re,n(i.value)+"+ stars",1)])):v("",!0)])):v("",!0)])])):v("",!0),e("div",Te,[y(re,{height:"100%",width:"100%",center:D.value,zoom:W.value,markers:R.value,"show-user-location":!0,onMarkerClick:T,onMapReady:G,onLocationFound:H,onLocationError:O,class:"h-full min-h-[500px] lg:min-h-[600px]"},{controls:L(()=>[...t[40]||(t[40]=[e("div",{class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-2 space-y-2"},[e("button",{class:"w-8 h-8 bg-blue-600 text-white rounded hover:bg-blue-700 flex items-center justify-center text-sm"}," ðŸ“ "),e("button",{class:"w-8 h-8 bg-gray-600 text-white rounded hover:bg-gray-700 flex items-center justify-center text-sm"}," ðŸ” ")],-1)])]),legend:L(()=>[...t[41]||(t[41]=[e("div",{class:"bg-card border border-border rounded-lg shadow-lg p-3 text-xs"},[e("h6",{class:"font-semibold mb-2 text-foreground"},"Legend"),e("div",{class:"space-y-1"},[e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-3 h-3 bg-blue-600 rounded-full"}),e("span",{class:"text-muted-foreground"},"Veterinary Clinic")]),e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-3 h-3 bg-red-600 rounded-full"}),e("span",{class:"text-muted-foreground"},"Emergency Hospital")]),e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-3 h-3 bg-green-600 rounded-full"}),e("span",{class:"text-muted-foreground"},"Your Location")])])],-1)])]),_:1},8,["center","zoom","markers"]),b.value.length===0&&(a.value||s.value||i.value||u.value)?(m(),c("div",Ge,[e("div",{class:"bg-card border border-border rounded-xl p-6 max-w-sm mx-4 text-center shadow-lg pointer-events-auto"},[t[42]||(t[42]=e("svg",{class:"w-12 h-12 mx-auto mb-4 text-muted-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.172 16.172a4 4 0 015.656 0M9 12h6m-6-4h6m2 5.291A7.962 7.962 0 0112 15c-2.347 0-4.518-.826-6.207-2.209M12 21C8.686 21 6 18.314 6 15c0-3.314 2.686-6 6-6s6 2.686 6 6c0 3.314-2.686 6-6 6z"})],-1)),t[43]||(t[43]=e("h3",{class:"text-lg font-semibold text-foreground mb-2"},"No Clinics Found",-1)),t[44]||(t[44]=e("p",{class:"text-muted-foreground mb-4"}," No clinics match your current filters. You can still navigate the map. ",-1)),e("button",{onClick:F,class:"bg-primary text-primary-foreground px-4 py-2 rounded-lg hover:bg-primary/90 text-sm font-medium"}," Clear Filters ")])])):v("",!0)])],64))])])]),_:1})],64))}}),ot=ae(He,[["__scopeId","data-v-6a6b9433"]]);export{ot as default};
